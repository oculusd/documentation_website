<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OculusD Libraries and Application Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="scribbler-global.css">
    <link rel="stylesheet" href="scribbler-doc.css">
    <link rel="author" href="humans.txt">
    <link rel="shortcut icon" href="favicon.png">
  </head>
  <body>
    <div class="doc__bg"></div>
    <nav class="header">
      <h1 class="logo">OculusD <span class="logo__thin">Docs</span></h1>
      <ul class="menu">
        <div class="menu__item toggle"><span></span></div>
        <li class="menu__item"><a href="doc.html" class="link link--dark"><i class="fa fa-book"></i> Documentation</a></li>
        <li class="menu__item"><a href="index.html" class="link link--dark"><i class="fa fa-home"></i> Home</a></li>
        <li class="menu__item"><a href="https://github.com/oculusd" class="link link--dark"><i class="fa fa-github"></i> Github</a></li>
      </ul>
    </nav>
    <div class="wrapper">
      <article class="doc__content">

        <!-- 
            TABLE OF CONTENTS
        -->
        <section>
        <h3 class="section__title">Summary of Contents</h3>
        <p>
            <ul>
                <li><u><a href="#menu_1">Loading a Root Account</a></u></li>
                <li><u><a href="#menu_2">Authenticating with a Root Account</a></u></li>
                <li><u><a href="#menu_3">Defining a new Thing</a></u></li>
                <li><u><a href="#menu_4">Deleting a Thing</a></u></li>
                <li><u><a href="#menu_5">Reset a Root Account</a></u></li>
            </ul>
        </p>
        
        </section>

        <!-- 
            TEMPLATE SECTION

        <section class="js-section">
            <h3 class="section__title" id="menu_1">HEADING</h3>
            <p>
                CONTENT
            </p>


            < !--    STEP   -- >
            <div style="margin-left: 50px">
                <h4 class="section__title">STEP HEADING</h4>
                <div style="margin-left: 50px">
                    <p>
                        CONTENT
                    </p>
                </div>
            </div>
              

            < !-- CODE BLOCK EXAMPLE -- >
            <p>
                EXAMPLE:
                <div  style="background-color: rgb(226, 225, 225);">
                    <pre>
                        <code>
... CODE ...
                        </code>
                    </pre>
                </div> 
            </p>
            <p>
                <div style="margin-left: 50px">
                    <b>Required Input Parameters</b><br />      
                    <table id="rip01">
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
                </div>
            </p>
            < !-- /CODE BLOCK EXAMPLE -- >


            <hr />
        </section>
        -->

        <!--
                SECTION: Loading a Root Account
        -->
        <section class="js-section">
            <h3 class="section__title" id="menu_1">Loading a Root Account</h3>
            <p>
                Assuming a root account was created and activated, with any new execution of an application or using the 
                libraries manually, the root account must be loaded to perform certain administrative functions.
            </p>
            <p>
                Example session:
                <div  style="background-color: rgb(226, 225, 225);">
                    <pre>
                        <code>
>>> from odc_pyadminlibs.persistence.root_account_persistence import read_root_account_by_email_address
>>> from odc_pycommons import HOME
>>> root_account = read_root_account_by_email_address(email_address='your-name@example.tld', persistence_path=HOME, persistence_file='root_account')
                        </code>
                    </pre>
                </div> 
            </p>
            <p>   
                <div style="margin-left: 50px">
                    <b>Required Input Parameters</b><br />     
                    <table id="rip01">
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>email_address</td>
                            <td>String</td>
                            <td>The e-mail address the root account was registered and activated with</td>
                        </tr>
                        <tr>
                            <td>persistence_path</td>
                            <td>String</td>
                            <td>There is no default, therefore the value must be provided. In most cases <i>HOME</i> should be sufficient.</td>
                        </tr>
                        <tr>
                            <td>persistence_file</td>
                            <td>String</td>
                            <td>There is no default, therefore the value must be provided. In most cases <i>'root_account'</i> should be sufficient.</td>
                        </tr>
                    </table>
                </div>
            </p>

            <hr />
        </section>


        <!--
                SECTION: Authenticating with a Root Account
        -->
        <section class="js-section">
            <h3 class="section__title" id="menu_2">Authenticating with a Root Account</h3>
            <p>
                Once a root account is <u><a href="#menu_1">loaded</a></u> an authentication token needs to be obtained 
                before administrative functions can be performed
            </p>
            <p>
                There are two possible scenarios:
                <ol>
                    <li>Scenario where the root account was persisted with the passphrase (as in the <u><a href="doc_intro.html#menu_3">introductory example</a></u>)</li>
                    <li>Scenario where the passphrase was not persisted with the root account, in which case it must be added after the root account is loaded</li>
                </ol>
            </p>


            <!--    SCENARIO 1  -->
            <div style="margin-left: 50px">
                <h4 class="section__title">Scenario: passphrase loaded with root account</h4>
                <div style="margin-left: 50px">
                    <p>
                        The following example demonstrates the authentication of the root account with the passphrase loaded with the root account
                    </p>
                    <p>
                        <div  style="background-color: rgb(226, 225, 225);">
                            <pre>
                                <code>
>>> from odc_pyadminlibs.actions.authentication import authenticate_root_account
>>> auth_result = authenticate_root_account(root_account=root_account, persist_token=True)
>>> auth_result
{
    'IsError': False, 
    'TraceId': None, 
    'RemoteTraceId': '20181113-4108-4885-4668-3549', 
    'ErrorMessage': None, 
    'Message': 'Authentication successful. Session expires (UTC): 1542167041', 
    'RootAccountObj': &#60;odc_pycommons.models.RootAccount object at 0x1041ce4a8&#62;
}
>>> root_account = auth_result['RootAccountObj']
                                </code>
                            </pre>
                        </div> 
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Required Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>root_account</td>
                                    <td>RootAccount</td>
                                    <td>The root account as loaded, including the passphrase</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Optional Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>persist_token</td>
                                    <td>Boolean</td>
                                    <td>Indicate if the returned authentication token must be persisted. Default=False</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                </div>
            </div>

            <!--    SCENARIO 2  -->
            <div style="margin-left: 50px">
                    <h4 class="section__title">Scenario: passphrase added manually</h4>
                    <div style="margin-left: 50px">
                        <p>
                            Just after loading the root account, add the passphrase and then follow the example of the first scenario (above)
                        </p>
                        <p>
                            <div  style="background-color: rgb(226, 225, 225);">
                                <pre>
                                    <code>
>>> root_account.passphrase = '... your passphrase ...'
                                    </code>
                                </pre>
                            </div> 
                        </p>
                    </div>
                </div>

            <hr />
        </section>


        <!--
                SECTION: Defining a new Thing
        -->
        <section class="js-section">
            <h3 class="section__title" id="menu_3">Defining a new Thing</h3>
            <p>
                A <i>Thing</i> consists of various elements, as can be seen in the block diagram below:
            </p>
            <p>
                <img src="images/thing_block.png">
            </p>
            <p>
                To define a <i>Thing</i>, it is required to work from the inside out. The following example will define 
                a Unix based operating system (Linux or Mac OSX) as the <i>Thing</i> with the <u><a href="https://en.wikipedia.org/wiki/Load_(computing)" target="_blank">load average</a></u> sensor
                containing three axis for 1 minute, 5 minutes and 15 minutes load averages.
            </p>
            <p>
                The following example require a <u><a href="doc_intro.html#menu_3">registered root account</a></u> which has been properly <u><a href="doc_root_account_admin_functions.html#menu_2">authenticated</a></u>
            </p>


            <!--    STEP 1: Define the Sensor Axis  -->
            <div style="margin-left: 50px">
                <h4 class="section__title">Step 1: Define the Sensor Axis</h4>
                <div style="margin-left: 50px">
                    <p>
                        A total of three axis needs to be defined:
                    </p>
                    <p>
                        <div  style="background-color: rgb(226, 225, 225);">
                            <pre>
                                <code>
>>> from odc_pycommons.models import SensorAxis
>>> load1_axis = SensorAxis(axis_name='1 Minute Load Average', axis_user_defined_type='Decimal', axis_data_type='NUMBER')
>>> load5_axis = SensorAxis(axis_name='5 Minute Load Average', axis_user_defined_type='Decimal', axis_data_type='NUMBER')
>>> load15_axis = SensorAxis(axis_name='15 Minute Load Average', axis_user_defined_type='Decimal', axis_data_type='NUMBER')
                                </code>
                            </pre>
                        </div> 
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Required Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>axis_name</td>
                                    <td>String</td>
                                    <td>A human friendly name</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Optional Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>axis_user_defined_type</td>
                                    <td>String</td>
                                    <td>Freeform field. Default='unknown-type'</td>
                                </tr>
                                <tr>
                                    <td>axis_data_type</td>
                                    <td>String</td>
                                    <td>Either a STRING, NUMBER or BOOLEAN. Default='NUMBER'</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                </div>
            </div>


            <!--    STEP 2: Define the Sensor  -->
            <div style="margin-left: 50px">
                <h4 class="section__title">Step 2: Define the Sensor</h4>
                <div style="margin-left: 50px">
                    <p>
                        Once the axis are defined, the <i>Sensor</i> needs to be defined and the axis added:
                    </p>
                    <p>
                        <div  style="background-color: rgb(226, 225, 225);">
                            <pre>
                                <code>
>>> from odc_pycommons.models import Sensor
>>> load_sensor = Sensor(sensor_name='Load Sensor', sensor_description='Load Average of the System')
>>> load_sensor.add_sensor_axis(sensor_axis=load1_axis)
>>> load_sensor.add_sensor_axis(sensor_axis=load5_axis)
>>> load_sensor.add_sensor_axis(sensor_axis=load15_axis)
                                </code>
                            </pre>
                        </div> 
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Required Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>sensor_name</td>
                                    <td>String</td>
                                    <td>A human friendly name</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Optional Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>sensor_description</td>
                                    <td>String</td>
                                    <td>A freeform description field. Default=None</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                </div>
            </div>


            <!--    STEP 3: Define the Thing  -->
            <div style="margin-left: 50px">
                <h4 class="section__title">Step 3: Define the Thing</h4>
                <div style="margin-left: 50px">
                    <p>
                        The following example will bring all the parts together in the final <i>Thing</i> definition.
                    </p>
                    <p>
                        <div  style="background-color: rgb(226, 225, 225);">
                            <pre>
                                <code>
>>> from odc_pycommons.models import Thing
>>> my_computer = Thing(thing_name='My Home PC', thing_description='My iMac at home', thing_meta_data={'Darwin Kernel Version': '17.7.0'})
>>> my_computer.add_sensor(sensor=load_sensor)
                                </code>
                            </pre>
                        </div> 
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Required Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>thing_name</td>
                                    <td>String</td>
                                    <td>A human friendly name</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Optional Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>thing_description</td>
                                    <td>String</td>
                                    <td>A freeform description field. Default=None</td>
                                </tr>
                                <tr>
                                    <td>thing_meta_data</td>
                                    <td>dict</td>
                                    <td>Any meta-data that can be defined in a dict. <b><i>Note:</i></b> The dictionary will be converted to a JSON object. If this is not possible, for what ever reason, the default (None) will be used instead.</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                </div>
            </div>


            <!--    STEP 4: Register the Thing  -->
            <div style="margin-left: 50px">
                <h4 class="section__title">Step 3: Register the Thing</h4>
                <div style="margin-left: 50px">
                    <p>
                        Finally the new <i>Thing</i> can be registered with the authenticated root account:
                    </p>
                    <p>
                        <div  style="background-color: rgb(226, 225, 225);">
                            <pre>
                                <code>
>>> from odc_pyadminlibs.actions.register import thing_registration
>>> registration_result = thing_registration(root_account=root_account, thing=my_computer)
>>> registration_result
{
    'IsError': False, 
    'TraceId': None, 'RemoteTraceId': 
    '20181113-9955-1007-3552-3354', 
    'ErrorMessage': None, 
    'Message': 'The Data field contains your newly created thing ID. You will need this to perform maintenance tasks on the thing and to capture data.', 
    'Thing': &#60;odc_pycommons.models.Thing object at 0x104ef2278&#62;
}
                                </code>
                            </pre>
                        </div> 
                    </p>
                    <p>
                        <div style="margin-left: 50px">
                            <b>Required Input Parameters</b><br />      
                            <table id="rip01">
                                <tr>
                                    <th>Parameter</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                                <tr>
                                    <td>root_account</td>
                                    <td>RootAccount</td>
                                    <td>A RootAccount after it has been authenticated</td>
                                </tr>
                            </table>
                        </div>
                    </p>
                    <p>
                        Post successful registration, a new SQLite file will be created where the <i>Thing</i> 
                        definitions are saved. The file location (default) is at <i>$HOME/.oculusdcli/things</i>.
                    </p>
                    <p>
                        You can run your own queries against this database:
                        <div  style="background-color: rgb(226, 225, 225);">
                            <pre>
                                <code>
$ sqlite3 $HOME/.oculusdcli/things
SQLite version 3.19.3 2017-06-27 16:48:08
Enter ".help" for usage hints.
sqlite> .tables
sensor_axis_definition  sensor_definition       thing_definition      

sqlite> select * from thing_definition;
thingraall8c1oalnbo|raall8c1o|My Home PC|My iMac at home|{"Darwin Kernel Version": "17.7.0"}|

sqlite> select * from sensor_definition;
Load Sensor|thingraall8c1oalnbo|Load Average of the System

sqlite> select * from sensor_axis_definition;
Load Sensor|thingraall8c1oalnbo|1 Minute Load Average|Decimal|NUMBER
Load Sensor|thingraall8c1oalnbo|5 Minute Load Average|Decimal|NUMBER
Load Sensor|thingraall8c1oalnbo|15 Minute Load Average|Decimal|NUMBER
                                </code>
                            </pre>
                        </div> 
                    </p>
                </div>
            </div>


            <hr />
        </section>


        <!--
                SECTION: Deleting a Thing
        -->
        <section class="js-section">
            <h3 class="section__title" id="menu_4">Deleting a Thing</h3>
            <p>
                Coming soon....
            </p>

            <hr />
        </section>


        <!--
                SECTION: Reset a Root Account
        -->
        <section class="js-section">
                <h3 class="section__title" id="menu_5">Reset a Root Account</h3>
                <p>
                    Coming soon....
                </p>
    
                <hr />
            </section>
        

      </article>
    </div>

    <footer class="footer">For license information regarding the Scribbler documentation template <a href="vendor_license.txt" target="_blank" class="link link--light">please download and read the vendor_license.txt file</a>.</footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="scribbler.js"></script>
  </body>
</html>