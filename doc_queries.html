<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>OculusD Libraries and Application Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Nunito+Sans:300,400,600,700,800,900" rel="stylesheet">
    <link rel="stylesheet" href="scribbler-global.css">
    <link rel="stylesheet" href="scribbler-doc.css">
    <link rel="author" href="humans.txt">
    <link rel="shortcut icon" href="favicon.png">
  </head>
  <body>
    <div class="doc__bg"></div>
    <nav class="header">
      <h1 class="logo">OculusD <span class="logo__thin">Docs</span></h1>
      <ul class="menu">
        <div class="menu__item toggle"><span></span></div>
        <li class="menu__item"><a href="doc.html" class="link link--dark"><i class="fa fa-book"></i> Documentation</a></li>
        <li class="menu__item"><a href="index.html" class="link link--dark"><i class="fa fa-home"></i> Home</a></li>
        <li class="menu__item"><a href="https://github.com/oculusd" class="link link--dark"><i class="fa fa-github"></i> Github</a></li>
      </ul>
    </nav>
    <div class="wrapper">
      <article class="doc__content">

        <!-- 
            TABLE OF CONTENTS
        -->
        <section>
        <h3 class="section__title">Summary of Contents</h3>
        <p>
            <ul>
                <li><u><a href="#menu_1">Simple Queries</a></u></li>
                <!-- TODO: Add more sections here.... -->
            </ul>
        </p>
        
        </section>

        <!-- 
            TEMPLATE SECTION

        <section class="js-section">
            <h3 class="section__title" id="menu_1">HEADING</h3>
            <p>
                CONTENT
            </p>


            < !--    STEP   -- >
            <div style="margin-left: 50px">
                <h4 class="section__title">STEP HEADING</h4>
                <div style="margin-left: 50px">
                    <p>
                        CONTENT
                    </p>
                </div>
            </div>
              

            < !-- CODE BLOCK EXAMPLE -- >
            <p>
                EXAMPLE:
                <div  style="background-color: rgb(226, 225, 225);">
                    <pre>
                        <code>
... CODE ...
                        </code>
                    </pre>
                </div> 
            </p>
            <p>
                <div style="margin-left: 50px">
                    <b>Required Input Parameters</b><br />      
                    <table id="rip01">
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
                </div>
            </p>
            < !-- /CODE BLOCK EXAMPLE -- >


            <hr />
        </section>
        -->

        <!--
                SECTION: __COMPLETE_ME__
        -->
        <section class="js-section">
            <h3 class="section__title" id="menu_1">Simple Queries</h3>
            <p>
                The current query interface allow for retrieving <i>Sensor</i> data for a <i>Thing</i> within a date 
                range.
            </p>
            <p>
                The example below demonstrates the fetching of data since the beginning of time and saving the results 
                in a file. Assumptions:
                <ul>
                    <li>The root account has been created and activated [<u><a href="doc_intro.html">see how here...</a></u>]</li>
                    <li>The root account has been authenticated [<u><a href="doc_root_account_admin_functions.html#menu_2">see how here...</a></u>]</li>
                    <li>The <i>RootAccount</i> object is loaded in a variable called <i>root_account</i></li>
                </ul>
            </p>
            
            <!-- CODE BLOCK EXAMPLE -->
            <p>
                EXAMPLE (assuming root_account has been loaded already):
                <div  style="background-color: rgb(226, 225, 225);">
                    <pre>
                        <code>
>>> from odc_pyadminlibs.actions.queries import query_thing_sensor
>>> from odc_pyadminlibs.persistence.thing_persistence import read_all_things_for_linked_root_account_id
>>> things = read_all_things_for_linked_root_account_id(linked_root_account_id=root_account.root_account_ref, persistence_path=HOME, persistence_file='things')
>>> thing = things['...your thing id...']
>>> from odc_pyadminlibs.actions.queries import query_thing_sensor
>>> query_result = query_thing_sensor(persist_to_file=True, file_path='/tmp', root_account=root_account, thing=thing, sensor_name='Load Sensor', timestamp_start=0)
>>> query_result
{
    'IsError': False, 
    'TraceId': None, 
    'RemoteTraceId': None, 
    'ErrorMessage': None, 
    'Message': 'Number of records captured: 3', 
    'TotalRecordsReturned': 12, 
    'CsvData': '... very long string with CSV data ...', 
    'PersistedFilename': '/tmp/My-Home-PC_1543296895__all-sensors.csv'
}
>>> exit()
$ cat /tmp/My-Home-PC_1543296895__all-sensors.csv
timestamp,1 Minute Load Average,15 Minute Load Average,5 Minute Load Average
1542472807,1.3369140625,1.89404296875,1.708984375
1542472720,1.552734375,1.9560546875,1.83740234375
1542336213,1.77587890625,1.9228515625,1.83154296875
1542336002,1.3427734375,1.9638671875,1.83984375
1542335681,2.0390625,2.08251953125,2.17626953125
1542335630,2.671875,2.12060546875,2.29736328125
1542335512,2.60595703125,2.06884765625,2.18701171875
1542335469,2.2783203125,2.0205078125,2.06103515625
1542335424,2.12060546875,2.01025390625,2.0302734375
1542335374,1.69677734375,1.982421875,1.94775390625
1542333698,2.2294921875,1.994140625,1.99462890625
1542245852,1.990234375,1.919921875,1.88525390625
                        </code>
                    </pre>
                </div> 
            </p>
            <p>
                <div style="margin-left: 50px">
                    <b>Required Input Parameters</b><br />      
                    <table id="rip01">
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>root_account</td>
                            <td>RootAccount</td>
                            <td>An authenticated <i>RootAccount</i></td>
                        </tr>
                        <tr>
                            <td>thing</td>
                            <td>Thing</td>
                            <td>The <i>Thing</i> you want to query</td>
                        </tr>
                        <tr>
                            <td>sensor_name</td>
                            <td>str</td>
                            <td>A sensor name as defined in the <i>Thing</i></td>
                        </tr>
                    </table>
                </div>
            </p>
            <p>
                <div style="margin-left: 50px">
                    <b>Optional Input Parameters</b><br />      
                    <table id="rip01">
                        <tr>
                            <th>Parameter</th>
                            <th>Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>timestamp_start</td>
                            <td>int</td>
                            <td>The Unix timestamp of the start time of the query. Default=24 hours ago from now</td>
                        </tr>
                        <tr>
                            <td>timestamp_stop</td>
                            <td>int</td>
                            <td>The Unix timestamp of the stop time of the query. Default=5 minutes ago from now</td>
                        </tr>
                        <tr>
                            <td>timestamp_source</td>
                            <td>str</td>
                            <td>Either 'SERVER' or 'ORIGIN'. Server time is the default. Origin time is the timestamp supplied when the data was captured as supplied by your <i>Thing</i></td>
                        </tr>
                        <tr>
                            <td>limit</td>
                            <td>int</td>
                            <td>How many rows to return per <i>Sensor</i> axis. If the sensor has 3 axes and the limit is 10, expect up to 30 records in total. Minimum is 1 and maximum is 10,000. Default=1000</td>
                        </tr>
                        <tr>
                            <td>axis_names</td>
                            <td>list of str</td>
                            <td>The <i>Sensor</i>axis names.</td>
                        </tr>
                        <tr>
                            <td>persist_to_file</td>
                            <td>bool</td>
                            <td>Flag to indicate if you want to save the result to file (CSV format). Default=False</td>
                        </tr>
                        <tr>
                            <td>file_path</td>
                            <td>str</td>
                            <td>Path to the file. Required if <i>persist_to_file</i> is True. Default=None</td>
                        </tr>
                        <tr>
                            <td>separate_file_per_axis</td>
                            <td>bool</td>
                            <td>The recordd for each <i>Sensor</i> axis will be saved in separate files if this is set to True. Default=False</td>
                        </tr>
                        <tr>
                            <td>service_region</td>
                            <td>str</td>
                            <td>The region in which your data is located. Ignored at this stage.</td>
                        </tr>
                        <tr>
                            <td>return_data_set</td>
                            <td>bool</td>
                            <td>If True, the data-set will be returned when the function returns. Default=True</td>
                        </tr>
                        <tr>
                            <td>trace_id</td>
                            <td>str</td>
                            <td>A trace-id that will be returned with the result. Can be used as the user sees fit and is useful in complex or large application for tracing purposes. Default=None</td>
                        </tr>
                    </table>
                </div>
            </p>
            <p>
                <div style="margin-left: 50px">
                    <b>Result Dict</b><br />      
                    <table id="rip01">
                        <tr>
                            <th>Dict Key</th>
                            <th>Value Type</th>
                            <th>Description</th>
                        </tr>
                        <tr>
                            <td>IsError</td>
                            <td>bool</td>
                            <td>Indicates if the function failed or not. Success=False</td>
                        </tr>
                        <tr>
                            <td>ErrorMessage</td>
                            <td>str</td>
                            <td>When <i>IsError</i> is True this will hold the error message or stack trace. Can be None</td>
                        </tr>
                        <tr>
                            <td>TraceId</td>
                            <td>str</td>
                            <td>Same value as the <i>trace_id</i> used when the function was called</td>
                        </tr>
                        <tr>
                            <td>RemoteTraceId</td>
                            <td>str</td>
                            <td>A trace-id returned by the remote service. Use this reference when asking for assistance from support</td>
                        </tr>
                        <tr>
                            <td>Message</td>
                            <td>str</td>
                            <td>Optional message from the remote service.</td>
                        </tr>
                        <tr>
                            <td>TotalRecordsReturned</td>
                            <td>int</td>
                            <td>If records where found, indicate the total records for all axes. A value of '0' indicates an empty data-set</td>
                        </tr>
                        <tr>
                            <td>CsvData</td>
                            <td>str</td>
                            <td>The CSV data in a str</i></td>
                        </tr>
                        <tr>
                            <td>PersistedFilename</td>
                            <td>str</td>
                            <td>Comma separated list of filename generated if the <i>persist_to_file</i> option was True</td>
                        </tr>
                    </table>
                </div>
            </p>
            <!-- /CODE BLOCK EXAMPLE -->


            <hr />
        </section>
        

      </article>
    </div>

    <footer class="footer">For license information regarding the Scribbler documentation template <a href="vendor_license.txt" target="_blank" class="link link--light">please download and read the vendor_license.txt file</a>.</footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="scribbler.js"></script>
  </body>
</html>